<h1>Contents</h1>

<% id = 0 %>  
<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
  <% @contents.each_key do |page| %>  
    <% @contents[page].each_key do |name| %>  
      <% div_id        = Cmsino::Content.div_id(page, name) %>  
      <% id = id + 1 %>  
      <% in_class, aria_expanded = (@last_edited == div_id) ? ['in', 'true'] : ['', 'false'] %>
      <div class="panel panel-default">
        <div class="panel-heading" role="tab" id="heading<%= div_id %>">
          <h4 class="panel-title">
            <%# FIXME use some id or check security in page name %>
            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse<%= id %>" aria-expanded="<%= aria_expanded %>" aria-controls="collapse<%= id %>">
              pagina: <strong><%= Cmsino::Page.description(page) %></strong> > <strong><%= name %></strong>
            </a>
          </h4>
        </div><!-- panel-heading -->

        <div id="collapse<%= id %>" class="panel-collapse collapse <%= in_class %>" role="tabpanel" aria-labelledby="heading<%= id %>">
          <div class="panel-body">
            <% @locales.each do |locale| %>  
              <span class="badge badge-info" style="width: 25px; text-align: center"><%= locale %></span>
              <% if @contents[page][name][locale] %>  
                <%= @contents[page][name][locale][:text] %>  
              <% else %>  
                -
              <% end %>
              <%= link_to icon(:pencil), @contents[page][name][locale] ? edit_cmsino_content_path(@contents[page][name][locale]) : new_cmsino_content_path(:page => page, :name => name, :locale => locale) %>
              <% if @contents[page][name][locale] %>
                <%= link_to icon(:trash), cmsino_content_path(@contents[page][name][locale]), :method => :delete %>
              <% end %>
              <br/>
            <% end %>
          </div><!-- panel-body -->
        </div><!-- panel-collapse -->
      </div><!-- panel -->
    <% end %><!-- name -->
  <% end %><!-- page -->
</div>

