<h1>Contents</h1>

<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
  <% @contents.each_key do |page| %>  
    <% @contents[page].each_key do |name| %>  
      <% div_id = Cmsino::Content.div_id(page, name) %>  
      <div class="panel panel-default">
        <div class="panel-heading" role="tab" id="heading<%= div_id %>">
          <h4 class="panel-title">
            <%# FIXME use some id or check security in page name %>
            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#<%= div_id %>" aria-expanded="false" aria-controls="<%= div_id %>">
              pagina: <strong><%= Cmsino::Page.description(page) %></strong> > <strong><%= name %></strong>
            </a>
          </h4>
        </div><!-- panel-heading -->

        <% in_class = (@last_edited == div_id) ? 'in' : '' %>
        <div id="<%= div_id %>" class="panel-collapse collapse <%= in_class %>" aria-labelledby="heading<%= div_id %>">
          <div class="panel-body">
            <% @locales.each do |locale| %>  
              <span class="badge badge-info" style="width: 25px; text-align: center"><%= locale %></span>
              <% if @contents[page][name][locale] %>  
                <%= @contents[page][name][locale][:text] %>  
              <% else %>  
                -
              <% end %>
              <%= link_to "<i class='icon-edit'></i>".html_safe, @contents[page][name][locale] ? edit_cmsino_content_path(@contents[page][name][locale]) : new_cmsino_content_path(:page => page, :name => name, :locale => locale) %>
              <% if @contents[page][name][locale] %>
                <%= link_to "<i class='icon-trash'></i>".html_safe, cmsino_content_path(@contents[page][name][locale]), :method => :delete %>
              <% end %>
              <br/>
            <% end %>
          </div><!-- panel-body -->
        </div><!-- panel-collapse -->
      </div><!-- panel -->
    <% end %><!-- name -->
  <% end %><!-- page -->
</div>

